#!/usr/bin/python3
import re
import os

def main(cookie, courseURL):
	
    os.system('curl ' + courseURL + ' --output src.txt')
    
    webSrcFile = open('src.txt')
    webSrcTxt = webSrcFile.read()
    videoList = re.findall(r'(\/getstats\?videoid=[0-9]*)', webSrcTxt)
    cookie = 'SACSID=' + cookie
    print(cookie)
    vidIterator = 1

    for video in videoList:

        video = str(video)
        video = video.replace('getstats', 'accounting').replace("videoid", "id")
        trueVidURL = 'https://www.pentesteracademy.com/' + video

        print('\n[+] Sending request for video ' + str(vidIterator) + '\n')
        os.system("curl -L '" + trueVidURL + "' --cookie '" + cookie + "' --output video_" + str(vidIterator) + '.mp4')
        print('\n[+] Video ' + str(vidIterator) + ' written to disk.')

        vidIterator += 1


if __name__ == '__main__':

    courseURL = input('Please enter the web address of the main course page: ')
    cookie = input('Please enter a valid session cookie value: ')
    main(cookie, courseURL)
    
